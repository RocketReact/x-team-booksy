{"version":3,"file":"index.js","sources":["../src/js/events.js","../src/js/contact-modal.js","../src/js/header.js","../src/js/feedbacks.js","../src/js/hero-swiper.js","../src/js/hero.js","../src/js/api.js","../src/js/render-functions.js","../src/js/books.js","../src/js/scroll-up.js","../src/js/footer.js","../src/js/cart.js","../src/js/modal-window-books.js"],"sourcesContent":["import Swiper from 'swiper';\nimport { Navigation, Pagination } from 'swiper/modules';\nimport 'swiper/css';\nimport 'swiper/css/navigation';\nimport 'swiper/css/pagination';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const swiper = new Swiper('.events-swiper', {\n    modules: [Navigation, Pagination],\n    wrapperClass: 'events-swiper-wrapper',\n    slideClass: 'events-swiper-slide',\n    loop: false,\n    spaceBetween: 20,\n    slidesPerView: 1,\n\n    breakpoints: {\n      768: {\n        slidesPerView: 2,\n      },\n      1440: {\n        slidesPerView: 3,\n      },\n    },\n\n    navigation: {\n      nextEl: '.events-swiper-button-next',\n      prevEl: '.events-swiper-button-prev',\n      disabledClass: 'events-swiper-button-disabled',\n    },\n\n    pagination: {\n      el: '.events-swiper-pagination',\n      clickable: true,\n    },\n  });\n\n  /* Random date function */\n\n  const timeElements = document.querySelectorAll('.events-item-time');\n  timeElements.forEach(el => {\n    el.textContent = getRandomFutureTime();\n  });\n});\n\nfunction getRandomFutureTime(daysAhead = 30) {\n  const now = new Date();\n  const future = new Date(\n    now.getTime() + Math.random() * daysAhead * 24 * 60 * 60 * 1000\n  );\n\n  const options = {\n    month: 'long',\n    day: 'numeric',\n    hour: '2-digit',\n    minute: '2-digit',\n    hour12: true,\n  };\n\n  return ` | ${future.toLocaleString('en-US', options)}`;\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst modal = document.getElementById('modal');\nconst backdrop = document.getElementById('modalBackdrop');\nconst closeBtn = document.getElementById('modalClose');\nconst form = document.getElementById('registerForm');\n\n//Key for localStorage\nconst STORAGE_KEY = 'register-form-data';\n\n// Field's links\nconst nameInput = form.elements.name;\nconst emailInput = form.elements.email;\nconst messageInput = form.elements.message;\n\n// ========Validation========//\n\nfunction isValidEmail(email) {\n  const emailRegex = /^\\w+(\\.\\w+)?@[a-zA-Z_]+?\\.[a-zA-Z]{2,3}$/;\n  return emailRegex.test(email);\n}\n\n// ==============================\n// Save to localStorage\n// ==============================\nfunction saveToStorage() {\n  const formData = {\n    name: nameInput.value.trim(),\n    email: emailInput.value.trim(),\n    message: messageInput.value.trim(),\n  };\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(formData));\n}\n\n// ==============================\n// Restore from localStorage\n// ==============================\nfunction restoreFromStorage() {\n  const saved = localStorage.getItem(STORAGE_KEY);\n  if (!saved) return;\n\n  try {\n    const data = JSON.parse(saved);\n    if (data.name) nameInput.value = data.name;\n    if (data.email) emailInput.value = data.email;\n    if (data.message) messageInput.value = data.message;\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to restore saved data.',\n      position: 'topRight',\n    });\n  }\n}\n\n// ==============================\n// Cleaning up after submit\n// ==============================\nfunction clearStorage() {\n  localStorage.removeItem(STORAGE_KEY);\n}\n\n// ==============================\n// Open/Close\n// ==============================\nconst openButtons = document.querySelectorAll('.open-modal-btn');\nconst subtitleEl = modal.querySelector('.modal-subtitle');\n\nopenButtons.forEach(btn => {\n  btn.addEventListener('click', e => {\n    const subtitle = btn.dataset.subtitle || '';\n    subtitleEl.textContent = subtitle;\n    openModal();\n  });\n});\n\nfunction openModal() {\n  modal.style.display = 'block';\n  backdrop.style.display = 'block';\n  document.body.classList.add('modal-open');\n  restoreFromStorage();\n}\n\nfunction closeModal() {\n  modal.style.display = 'none';\n  backdrop.style.display = 'none';\n  document.body.classList.remove('modal-open');\n}\n\n// ==============================\n// Event handlers\n// ==============================\n\ncloseBtn.addEventListener('click', closeModal);\nbackdrop.addEventListener('click', e => {\n  if (e.target === backdrop) {\n    closeModal();\n  }\n});\n\ndocument.addEventListener('keydown', e => {\n  if (e.key === 'Escape') closeModal();\n});\n\n[nameInput, emailInput, messageInput].forEach(input => {\n  input.addEventListener('input', saveToStorage);\n});\n\nform.addEventListener('submit', e => {\n  e.preventDefault();\n\n  const name = nameInput.value.trim();\n  const email = emailInput.value.trim();\n\n  // Clear previous errors\n  [nameInput, emailInput].forEach(input => {\n    input.addEventListener('input', () => {\n      input.classList.remove('error');\n      saveToStorage();\n    });\n  });\n\n  let hasError = false;\n\n  if (!name || !email) {\n    iziToast.warning({\n      title: 'Warning',\n      message: 'Please fill out required fields: Name and Email',\n      position: 'topRight',\n    });\n\n    if (!name) nameInput.classList.add('error');\n    if (!email) emailInput.classList.add('error');\n\n    hasError = true;\n  }\n\n  // Email validation includes @\n  if (email && !isValidEmail(email)) {\n    iziToast.error({\n      title: 'Invalid Email',\n      message: 'Please enter a valid email format (example@domain.com)',\n      position: 'topRight',\n    });\n    emailInput.classList.add('error');\n    hasError = true;\n  }\n\n  if (hasError) return;\n\n  try {\n    // Error emulation\n    if (email === 'error@example.com') {\n      throw new Error('Simulated server error');\n    }\n\n    iziToast.success({\n      title: 'Success',\n      message: 'Form submitted!',\n      position: 'topRight',\n    });\n\n    form.reset();\n    clearStorage();\n    closeModal();\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: `Something went wrong: ${error.message}`,\n      position: 'topRight',\n    });\n  }\n});\n","const burgerEl = document.querySelector('#burger-button');\nconst menuEl = document.querySelector('#mobile_menu');\nconst navListEl = document.querySelector('#nav-links');\nexport const body = document.body;\n\n// ? Відкриває мобільне меню\nconst onBurgerClick = e => {\n  menuEl.classList.add('mob-menu-open');\n  body.classList.add('no-scroll');\n};\n\n// ? Закриває мобільне меню\nconst closeMenuHandler = e => {\n  // ! Шукає найближчого предка по селектору, якщо такого нема - повертає null\n  const button = e.target.closest('button');\n  const navLink = e.target.closest('.nav-list-mob-link');\n  // ! null = false, якщо хоча б один елемент наявний, провірка проходить далі\n  if (button || navLink) {\n    menuEl.classList.remove('mob-menu-open');\n    body.classList.remove('no-scroll');\n  }\n};\n\n// ? ховає або показує потрібний бургер в залежності від в'юпорта\nconst hideElement = () => {\n  if (window.innerWidth >= 768) {\n    navListEl.classList.remove('visually-hidden');\n    burgerEl.classList.add('visually-hidden');\n  } else {\n    burgerEl.classList.remove('visually-hidden');\n    navListEl.classList.add('visually-hidden');\n  }\n};\n\nhideElement(); // ? Провірка в'юпорта при загрузці сторінки\nburgerEl.addEventListener('click', onBurgerClick);\nmenuEl.addEventListener('click', closeMenuHandler);\nwindow.addEventListener('resize', hideElement);\n\n// Fixed HEADER\n\nwindow.addEventListener('scroll', e => {\n  const header = document.querySelector('.header');\n  const badgeEl = document.querySelector('.cart-badge');\n  if (window.scrollY > 50) {\n    header.classList.add('scrolled-header');\n    badgeEl.classList.add('scrolled-badge');\n  } else {\n    header.classList.remove('scrolled-header');\n    badgeEl.classList.remove('scrolled-badge');\n  }\n});\n","import Swiper from 'swiper';\nimport { Navigation, Pagination, Keyboard } from 'swiper/modules';\nimport 'swiper/css';\nimport 'swiper/css/navigation';\nimport 'swiper/css/pagination';\nimport '../css/feedbacks.css';\n\nconst swiper = new Swiper('.swiper-feedback', {\n  modules: [Navigation, Pagination, Keyboard],\n  wrapperClass: 'swiper-wrapper-feedback',\n  slideClass: 'swiper-slide-feedback',\n  loop: false,\n  direction: 'horizontal',\n  slidesPerView: 1,\n  slidesPerGroup: 1,\n  centeredSlides: false,\n  simulateTouch: true,\n  touchRatio: 1,\n  grabCursor: true,\n  watchOverflow: true,\n  speed: 250,\n  spaceBetween: 24,\n\n  lazy: {\n    loadPrevNext: true,\n    loadOnTransitionStart: true,\n  },\n\n  breakpoints: {\n    768: {\n      slidesPerView: 2,\n      slidesPerGroup: 1,\n    },\n    1440: {\n      slidesPerView: 3,\n      slidesPerGroup: 1,\n    },\n  },\n\n  pagination: {\n    el: '.custom-swiper-pagination',\n    type: 'bullets',\n    clickable: true,\n    bulletClass: 'swiper-pagination-bullet',\n    bulletActiveClass: 'swiper-pagination-bullet-active',\n  },\n\n  navigation: {\n    nextEl: '.feedback-custom-swiper-button-next',\n    prevEl: '.feedback-custom-swiper-button-prev',\n    disabledClass: 'feedback-custom-swiper-button-disabled',\n  },\n\n  keyboard: {\n    enabled: true,\n    onlyInViewport: true,\n  },\n});\n\nfunction getCurrentSlidesPerGroup() {\n  const width = window.innerWidth;\n  if (width >= 1440) return 3;\n  if (width >= 768) return 2;\n  return 1;\n}\n\nfunction togglePaginationAndNavigation() {\n  const totalSlides = swiper.slides.length;\n  const currentGroup = getCurrentSlidesPerGroup();\n\n  const paginationEl = document.querySelector('.custom-swiper-pagination');\n  const prevBtn = document.querySelector('.feedback-custom-swiper-button-prev');\n  const nextBtn = document.querySelector('.feedback-custom-swiper-button-next');\n\n  if (totalSlides <= currentGroup) {\n    if (paginationEl) paginationEl.style.display = 'none';\n    if (prevBtn) prevBtn.style.display = 'none';\n    if (nextBtn) nextBtn.style.display = 'none';\n  } else {\n    if (paginationEl) paginationEl.style.display = '';\n    if (prevBtn) prevBtn.style.display = '';\n    if (nextBtn) nextBtn.style.display = '';\n  }\n}\n\ntogglePaginationAndNavigation();\n\n// На изменение размера окна — чтобы динамически обновлялось\nwindow.addEventListener('resize', () => {\n  togglePaginationAndNavigation();\n});","import Swiper from 'swiper';\nimport { Navigation, Pagination, Autoplay, Keyboard } from 'swiper/modules';\nimport 'swiper/css';\n\nconst swiper = new Swiper('.hero-swiper', {\n  modules: [Navigation, Pagination, Autoplay, Keyboard],\n  direction: 'horizontal',\n  loop: false,\n  spaceBetween: 16,\n  grabCursor: true,\n  autoplay: {\n    delay: 2500,\n    disableOnInteraction: true,\n    pauseOnMouseEnter: true,\n  },\n\n  keyboard: {\n    enabled: true,\n    onlyInViewport: true,\n  },\n\n  navigation: {\n    nextEl: '.hero-swiper-button-next',\n    prevEl: '.hero-swiper-button-prev',\n  },\n\n  on: {\n    slideChange(swiper) {\n      const nextBtn = document.querySelector('.hero-swiper-button-next');\n      const prevBtn = document.querySelector('.hero-swiper-button-prev');\n\n      swiper.isEnd\n        ? nextBtn?.classList.add('is-disabled')\n        : nextBtn?.classList.remove('is-disabled');\n\n      swiper.isBeginning\n        ? prevBtn?.classList.add('is-disabled')\n        : prevBtn?.classList.remove('is-disabled');\n    },\n\n    init(swiper) {\n      const prevBtn = document.querySelector('.hero-swiper-button-prev');\n      swiper.isBeginning\n        ? prevBtn?.classList.add('is-disabled')\n        : prevBtn?.classList.remove('is-disabled');\n    },\n  },\n});\ndocument\n  .querySelectorAll('.hero-swiper-button-prev, .hero-swiper-button-next')\n  .forEach(button => {\n    button.addEventListener('mouseup', () => {\n      button.blur();\n    });\n  });\n","const SLIDES = [\n  {\n    alt: 'Mug with book on the table',\n    text: 'Get 10% off your ',\n    highlight: 'first order',\n    link: '#books',\n    images: {\n      desktop: {\n        src: './img/desktop-webp/banner-1-desktop.webp',\n        src2x: './img/desktop-webp/banner-1-desktop@2x.webp',\n      },\n      tablet: {\n        src: './img/tablet-webp/banner-1-tablet.webp',\n        src2x: './img/tablet-webp/banner-1-tablet@2x.webp',\n      },\n      mobile: {\n        src: './img/mob-webp/banner-1-mob.webp',\n        src2x: './img/mob-webp/banner-1-mob@2x.webp',\n      },\n    },\n  },\n  {\n    alt: 'Glasses with book on the table',\n    text: 'Save 15% on ',\n    highlight: 'some books',\n    link: '#books',\n    images: {\n      desktop: {\n        src: './img/desktop-webp/banner-2-desktop.webp',\n        src2x: './img/desktop-webp/banner-2-desktop@2x.webp',\n      },\n      tablet: {\n        src: './img/tablet-webp/banner-2-tablet.webp',\n        src2x: './img/tablet-webp/banner-2-tablet@2x.webp',\n      },\n      mobile: {\n        src: './img/mob-webp/banner-2-mob.webp',\n        src2x: './img/mob-webp/banner-2-mob@2x.webp',\n      },\n    },\n  },\n  {\n    alt: 'Shelf with books',\n    text: 'Summer Sale! ',\n    highlight: 'Up to -40% discounts',\n    link: '#books',\n    images: {\n      desktop: {\n        src: './img/desktop-webp/banner-3-desktop.webp',\n        src2x: './img/desktop-webp/banner-3-desktop@2x.webp',\n      },\n      tablet: {\n        src: './img/tablet-webp/banner-3-tablet.webp',\n        src2x: './img/tablet-webp/banner-3-tablet@2x.webp',\n      },\n      mobile: {\n        src: './img/mob-webp/banner-3-mob.webp',\n        src2x: './img/mob-webp/banner-3-mob@2x.webp',\n      },\n    },\n  },\n  {\n    alt: 'Vase on the table',\n    text: 'Last chance to buy our ',\n    highlight: 'spring bestsellers',\n    link: '#books',\n    images: {\n      desktop: {\n        src: './img/desktop-webp/banner-4-desktop.webp',\n        src2x: './img/desktop-webp/banner-4-desktop@2x.webp',\n      },\n      tablet: {\n        src: './img/tablet-webp/banner-4-tablet.webp',\n        src2x: './img/tablet-webp/banner-4-tablet@2x.webp',\n      },\n      mobile: {\n        src: './img/mob-webp/banner-4-mob.webp',\n        src2x: './img/mob-webp/banner-4-mob@2x.webp',\n      },\n    },\n  },\n];\n\nconst wrapperContainer = document.querySelector('.hero-js');\nconst generateMarkup = arr => {\n  return arr\n    .map(slide => {\n      return `<li class=\"swiper-slide hero-swiper-slide\">\n      <picture>\n      <source media=\"(min-width: 1440px)\" type=\"image/webp\" srcset=\"${slide.images.desktop.src} 1x, ${slide.images.desktop.src2x} 2x\">\n      <source media=\"(min-width: 768px)\" type=\"image/webp\" srcset=\"${slide.images.tablet.src} 1x, ${slide.images.tablet.src2x} 2x\">\n          <img \n            src=\"${slide.images.mobile.src}\" \n            srcset=\"${slide.images.mobile.src} 1x, ${slide.images.mobile.src2x} 2x\"\n            loading=\"lazy\"\n            width=\"343\"\n            height=\"199\"\n            alt=\"${slide.alt}\" />\n          </picture>\n          <div class=\"banner-wrapper\">\n            <p class=\"hero-text\">\n              ${slide.text}<span class=\"hero-text-wrap\">${slide.highlight}</span>\n            </p>\n            <a class=\"hero-link\" href=\"#books-section\">Shop Now!</a>\n          </div>\n        </li>`;\n    })\n    .join('');\n};\n\nconst createGallery = slides => {\n  wrapperContainer.innerHTML = generateMarkup(slides);\n};\n\ncreateGallery(SLIDES);\n","import axios from 'axios';\nimport iziToast from 'izitoast';\n\naxios.defaults.baseURL = 'https://books-backend.p.goit.global/books/';\n\nlet categoriesCache = null;\nlet totalBooksCache = null;\n\n// Gets list of book categories\nexport async function getCategoryList() {\n  if (categoriesCache !== null) {\n    return categoriesCache;\n  }\n\n  try {\n    const response = await axios.get('category-list');\n    // Filter out empty or invalid categories\n    const filteredCategories = response.data.filter(\n      category =>\n        category &&\n        category.list_name &&\n        category.list_name.trim() !== '' &&\n        category.list_name.trim() !== ' '\n    );\n    categoriesCache = filteredCategories;\n    return filteredCategories;\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to load categories',\n      position: 'topRight',\n    });\n    return [];\n  }\n}\n\n// Gets list of top books\nexport async function getTopBooks() {\n  try {\n    const response = await axios.get('top-books');\n    return response.data;\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to load top books',\n      position: 'topRight',\n    });\n    return [];\n  }\n}\n\n// Gets books by category\nexport async function getBooksByCategory(category) {\n  try {\n    const encodedCategory = encodeURIComponent(category);\n    const response = await axios.get(`category?category=${encodedCategory}`);\n\n    return response.data;\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: `Failed to load books for category: ${category}`,\n      position: 'topRight',\n    });\n    return [];\n  }\n}\n\n// Gets book information by ID\nexport async function getBooksById(id) {\n  try {\n    const response = await axios.get(id);\n    return response.data;\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to load book details',\n      position: 'topRight',\n    });\n    return [];\n  }\n}\n\n// Gets all unique books from all categories\nexport async function getTotalBooks() {\n  if (totalBooksCache !== null) {\n    return totalBooksCache;\n  }\n  try {\n    const categories = await getCategoryList();\n    if (!categories || !Array.isArray(categories)) {\n      return [];\n    }\n    const categoryNames = categories\n      .filter(category => category.list_name)\n      .map(category => category.list_name);\n\n    const booksDataArrays = await Promise.all(\n      categoryNames.map(getBooksByCategory)\n    );\n\n    const allBooks = booksDataArrays.flat();\n\n    // Filter duplicates and books with zero price\n    const uniqueTitles = new Set();\n    const filteredBooks = allBooks.filter(book => {\n      // Remove books without title or with price 0.00\n      if (!book.title || !book.price || parseFloat(book.price) <= 0) {\n        return false;\n      }\n\n      const normalizedTitle = book.title.trim().toLowerCase();\n      if (uniqueTitles.has(normalizedTitle)) {\n        return false;\n      }\n\n      uniqueTitles.add(normalizedTitle);\n      return true;\n    });\n\n    totalBooksCache = filteredBooks;\n    return filteredBooks;\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to load all books',\n      position: 'topRight',\n    });\n    return [];\n  }\n}\n\n// Counts number of books in specific category\nexport async function getCountBooksByCategory(category) {\n  if (!category || category.trim() === '') {\n    return 0;\n  }\n\n  try {\n    const encodedCategory = encodeURIComponent(category);\n    const response = await axios.get(`category?category=${encodedCategory}`);\n    return response.data.length;\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: `Failed to count books in category: ${category}`,\n      position: 'topRight',\n    });\n    return 0;\n  }\n}\n","import {\n  getCategoryList,\n  getTopBooks,\n  getTotalBooks,\n  getBooksByCategory,\n  getCountBooksByCategory,\n} from './api.js';\nimport { getPaginationValue, setPaginationValue } from './books.js';\nimport iziToast from 'izitoast';\n\n// DOM elements\nexport const topBooksListEl = document.querySelector('.top-books-list');\nconst dropdownMenuEl = document.querySelector('.dropdown-menu');\nconst showMoreBtnEl = document.querySelector('.show-more-btn');\nconst showCountEl = document.querySelector('.show-count');\nconst booksWrapperEl = document.querySelector('.desk-books-nav-wrapper');\nconst booksLoaderEl = document.querySelector('.book-loader');\nconst showMoreLoaderEL = document.querySelector('.loader');\n\n// Global state variables\nexport let allTopBooks = [];\nexport let page = 1;\nexport const perPage = 4;\nexport let currentCategory = 'All categories';\n\n// Constants\nconst INITIAL_CATEGORY = 'Top';\n\n// Cache for total books count\nlet totalBooksCache = null;\n\nasync function getTotalBooksCount() {\n  if (totalBooksCache === null) {\n    const allBooks = await getTotalBooks();\n    totalBooksCache = allBooks.length;\n  }\n  return totalBooksCache;\n}\n\n// Main function for displaying books\nexport async function displayBooks(books, options = {}) {\n  // Destructure options with default values\n  const {\n    isInitialLoad = false,\n    selectedCategory = 'All categories',\n    resetContent = true,\n  } = options;\n\n  try {\n    // Clear content and reset pagination if needed\n    if (resetContent) {\n      clearBooksContent();\n      resetPage();\n    }\n\n    // Input data validation\n    if (!Array.isArray(books)) {\n      iziToast.warning({\n        title: 'Warning',\n        message: 'displayBooks: books should be an array',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    // Filter books from duplicates and zero prices\n    const filteredBooks = filterBooks(books);\n\n    // Update global state\n    updateAllBooks(filteredBooks);\n    currentCategory = selectedCategory;\n\n    // Calculate number of books for first screen\n    const booksPerScreen = getBooksPerScreen();\n    const initialBooks = filteredBooks.slice(0, booksPerScreen);\n\n    setPaginationValue(initialBooks.length);\n\n    // Display books\n    if (initialBooks.length > 0) {\n      createTopBooksList(initialBooks);\n    } else {\n      showEmptyState();\n    }\n\n    // Initialize categories only on first load\n    if (isInitialLoad) {\n      await initializeCategories();\n    }\n\n    // Update counter and manage \"Show more\" button\n    await updateBooksCounter();\n    toggleShowMoreButton(filteredBooks.length > booksPerScreen);\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Error in displayBooks function',\n      position: 'topRight',\n    });\n    showErrorState();\n  }\n}\n\n// Create HTML markup for books list\nexport function createTopBooksList(books) {\n  const markup = books\n    .map(\n      book => `\n        <li class=\"top-book-item\" id=\"${book._id}\">\n            <img\n              class=\"top-book-img\"\n              src=\"${book.book_image}\"\n              alt=\"${book.title}\"\n              width=\"343\" height=\"488\"\n              loading=\"lazy\"\n            />\n          <div class=\"top-book-info\">\n          <div class=\"top-book-info-wrap\">\n            <h3 class=\"top-book-title\">${book.title.toLowerCase()}</h3>\n            <p class=\"top-book-price\">$${book.price}</p>\n            </div>\n            <p class=\"top-book-author\">${book.author.toLowerCase()}</p>\n          </div>\n          <button class=\"top-book-btn\" type=\"button\">\n            Learn More\n          </button>\n        </li>\n      `\n    )\n    .join('');\n\n  topBooksListEl.insertAdjacentHTML('beforeend', markup);\n}\n\n// Filter valid categories\nfunction filterValidCategories(categories) {\n  return categories.filter(\n    category =>\n      category &&\n      category.list_name &&\n      category.list_name.trim() !== '' &&\n      category.list_name.trim() !== ' ' &&\n      category.list_name.toLowerCase() !== 'undefined' &&\n      category.list_name.toLowerCase() !== 'null'\n  );\n}\n\n// Create categories list in dropdown\nasync function createCategoryBooksList(arr) {\n  // Filter valid category names\n  const validCategories = arr.filter(\n    categoryName =>\n      categoryName &&\n      categoryName.trim() !== '' &&\n      categoryName.trim() !== ' ' &&\n      categoryName.toLowerCase() !== 'undefined' &&\n      categoryName.toLowerCase() !== 'null'\n  );\n\n  const markup = validCategories\n    .map(item => `<li class=\"dropdown-item\"><p>${item}</p></li>`)\n    .join('');\n\n  dropdownMenuEl.insertAdjacentHTML('beforeend', markup);\n}\n\n// Display books counter\nexport async function createShowCase(count, total) {\n  showCountEl.innerHTML = '';\n  const markup = `<p>Showing ${count} of ${total}</p>`;\n  showCountEl.insertAdjacentHTML('beforeend', markup);\n}\n\n// Pagination functions\nexport function getBooksPerScreen() {\n  const screenWidth = window.innerWidth;\n  return screenWidth >= 768 ? 24 : 10;\n}\n\nexport function getPage() {\n  return page;\n}\n\nexport function incrementPage() {\n  page += 1;\n}\n\nexport function resetPage() {\n  page = 1;\n}\n\n// Book filtering function\nfunction filterBooks(books) {\n  const uniqueTitles = new Set();\n\n  return books.filter(book => {\n    // Remove books without title or with price 0.00\n    if (!book.title || !book.price || parseFloat(book.price) <= 0) {\n      return false;\n    }\n\n    // Normalize title (remove spaces and convert to lowercase)\n    const normalizedTitle = book.title.trim().toLowerCase();\n\n    // Check if this title already exists\n    if (uniqueTitles.has(normalizedTitle)) {\n      return false;\n    }\n\n    // Add title to unique set\n    uniqueTitles.add(normalizedTitle);\n    return true;\n  });\n}\n\n// State management functions\nexport function updateAllBooks(books) {\n  allTopBooks.length = 0;\n  allTopBooks.push(...books);\n}\n\nexport const showShowMoreBtn = () =>\n  showMoreBtnEl.classList.remove('is-hidden');\n\nexport const hideShowMoreBtn = () => showMoreBtnEl.classList.add('is-hidden');\n\n// Helper functions for improved displayBooks\nfunction clearBooksContent() {\n  topBooksListEl.innerHTML = '';\n}\n\nfunction showEmptyState() {\n  topBooksListEl.innerHTML = '<li class=\"empty-state\">No books found</li>';\n}\n\nfunction showErrorState() {\n  topBooksListEl.innerHTML = '<li class=\"error-state\">Error loading books</li>';\n}\n\nasync function initializeCategories() {\n  try {\n    const allCategories = await getCategoryList();\n    const validCategories = filterValidCategories(allCategories);\n\n    const categoryPromises = validCategories.map(async category => {\n      try {\n        const books = await getBooksByCategory(category.list_name);\n        const filteredBooks = filterBooks(books);\n\n        return {\n          name: category.list_name,\n          count: filteredBooks.length,\n        };\n      } catch (error) {\n        iziToast.error({\n          title: 'Error',\n          message: 'Error initializing categories',\n          position: 'topRight',\n        });\n        return {\n          name: category.list_name,\n          count: 0,\n        };\n      }\n    });\n\n    const results = await Promise.all(categoryPromises);\n\n    const categoriesWithBooks = results\n      .filter(result => result.count > 0)\n      .map(result => result.name);\n\n    createCategoryBooksList(categoriesWithBooks);\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Error initializing categories',\n      position: 'topRight',\n    });\n  }\n  hideBooksLoader();\n}\n\nasync function updateBooksCounter() {\n  try {\n    const totalCount = await getTotalBooksCount();\n\n    const renderedCount = getPaginationValue();\n    createShowCase(renderedCount, totalCount);\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Error updating books counter',\n      position: 'topRight',\n    });\n  }\n}\n\nexport { updateBooksCounter };\n\nfunction toggleShowMoreButton(shouldShow) {\n  if (shouldShow) {\n    showShowMoreBtn();\n  } else {\n    hideShowMoreBtn();\n  }\n}\n// Books loader when page is start\nexport function showBooksLoader() {\n  booksLoaderEl.classList.remove('visually-hidden');\n  booksWrapperEl.classList.add('visually-hidden');\n}\n\nfunction hideBooksLoader() {\n  booksLoaderEl.classList.add('visually-hidden');\n  booksWrapperEl.classList.remove('visually-hidden');\n}\n\n// Show more btn loader\nfunction showLoadMoreBtn() {\n  showMoreLoaderEL.classList.remove('visually-hidden');\n  showMoreBtnEl.classList.add('visually-hidden');\n}\n\nfunction hideLoadMoreBtn() {\n  showMoreLoaderEL.classList.add('visually-hidden');\n  showMoreBtnEl.classList.remove('visually-hidden');\n}\n\n// App initialization functions\nfunction extractBooksFromCategories(categoriesData) {\n  if (!Array.isArray(categoriesData)) {\n    iziToast.warning({\n      title: 'Warning',\n      message: 'Incorrect categories data',\n      position: 'topRight',\n    });\n    return [];\n  }\n\n  return categoriesData.flatMap(category => {\n    if (category && Array.isArray(category.books)) {\n      return category.books;\n    }\n    return [];\n  });\n}\n\nfunction showLoadingState() {\n  const loadingEl = document.querySelector('.loading-indicator');\n  if (loadingEl) {\n    loadingEl.classList.remove('is-hidden');\n  }\n}\n\nfunction hideLoadingState() {\n  const loadingEl = document.querySelector('.loading-indicator');\n  if (loadingEl) {\n    loadingEl.classList.add('is-hidden');\n  }\n}\n\nfunction showInitializationError() {\n  topBooksListEl.innerHTML = `\n    <li class=\"error-state\">\n      <p>Failed to load books. Please refresh the page.</p>\n      <button onclick=\"location.reload()\" class=\"retry-btn\">Refresh</button>\n    </li>\n  `;\n}\n\n// App initialization function\nasync function initializeApp() {\n  try {\n    showLoadingState();\n\n    const topBooksData = await getTopBooks();\n    const initialBooks = extractBooksFromCategories(topBooksData);\n\n    await displayBooks(initialBooks, {\n      isInitialLoad: true,\n      selectedCategory: INITIAL_CATEGORY,\n      resetContent: true,\n    });\n\n    hideLoadingState();\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'App initialization error',\n      position: 'topRight',\n    });\n    showInitializationError();\n  }\n}\n\n// Dropdown menu creation function\nexport function createDropdown(selector) {\n  const dropdown = document.querySelector(selector);\n  const btn = dropdown.querySelector('.dropdown-btn');\n  const menu = dropdown.querySelector('.dropdown-menu');\n  const text = dropdown.querySelector('.dropdown-text');\n  const items = dropdown.querySelectorAll('.dropdown-item');\n\n  // Set initial value\n  const selected = dropdown.querySelector('.dropdown-item.selected');\n  if (selected) text.textContent = selected.textContent;\n\n  // Open/close\n  btn.onclick = () => dropdown.classList.toggle('open');\n\n  // Item selection\n  items.forEach(item => {\n    item.onclick = () => {\n      items.forEach(i => i.classList.remove('selected'));\n      item.classList.add('selected');\n      text.textContent = item.textContent;\n      dropdown.classList.remove('open');\n\n      // Callback\n      dropdown.dispatchEvent(\n        new CustomEvent('change', {\n          detail: { value: item.dataset.value, text: item.textContent },\n        })\n      );\n    };\n  });\n\n  // Close when clicking outside element\n  document.onclick = e => {\n    if (!dropdown.contains(e.target)) {\n      dropdown.classList.remove('open');\n    }\n  };\n}\n\n// App initialization\ndocument.addEventListener('DOMContentLoaded', initializeApp);\n\n// Dropdown initialization\ncreateDropdown('#categoryDropdown');\n\n// Empty event handler for dropdown (can be extended if needed)\ndocument.querySelector('#categoryDropdown').addEventListener('change', e => {});\n","import { getBooksByCategory, getTotalBooks } from './api.js';\nimport {\n  displayBooks,\n  getBooksPerScreen,\n  createTopBooksList,\n  hideShowMoreBtn,\n  getPage,\n  incrementPage,\n  allTopBooks,\n  updateBooksCounter,\n  showBooksLoader,\n} from './render-functions.js';\nimport iziToast from 'izitoast';\n\nconst dropdownMenuEl = document.querySelector('.dropdown-menu');\nconst showMoreBtnEl = document.querySelector('.show-more-btn');\n\nconst perPage = 4;\nlet paginationValue = getBooksPerScreen();\n\nexport function getPaginationValue() {\n  return paginationValue;\n}\n\nexport function setPaginationValue(value) {\n  paginationValue = value;\n}\n\n// Button show more\nasync function handleShowMore() {\n  showMoreBtnEl.blur();\n\n  incrementPage();\n  const page = getPage();\n  const booksForScreen = getBooksPerScreen();\n\n  const start = booksForScreen + (page - 2) * perPage;\n  const end = start + perPage;\n  const nextBooks = allTopBooks.slice(start, end);\n  paginationValue = Math.min(end, allTopBooks.length);\n\n  createTopBooksList(nextBooks);\n\n  await updateBooksCounter();\n\n  // Smooth scroll\n  const firstItemEl = document.querySelector('.top-book-item');\n\n  if (firstItemEl) {\n    const cardHeight = firstItemEl.getBoundingClientRect().height;\n\n    window.scrollBy({\n      top: cardHeight,\n      behavior: 'smooth',\n    });\n  }\n\n  // If reached end of list\n  if (end >= allTopBooks.length) {\n    hideShowMoreBtn();\n    iziToast.info({\n      message: \"You've reached the end of the book list.\",\n      position: 'topRight',\n    });\n  }\n}\n\n// Filter valid categories\nfunction filterValidCategories(category) {\n  return (\n    category &&\n    category.trim() !== '' &&\n    category.trim() !== ' ' &&\n    category.toLowerCase() !== 'undefined' &&\n    category.toLowerCase() !== 'null'\n  );\n}\n\n// Select dropdown\nasync function handleCategoryClick(event) {\n  const categoryItem = event.target.closest('.dropdown-item');\n  if (!categoryItem) return;\n\n  const selectedCategory = categoryItem.textContent.trim();\n\n  // Filter out invalid categories\n  if (!filterValidCategories(selectedCategory)) {\n    iziToast.warning({\n      title: 'Warning',\n      message: 'Invalid category selected',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  // Remove selected class from all items and add to current\n  const allDropdownItems = document.querySelectorAll('.dropdown-item');\n  allDropdownItems.forEach(item => {\n    item.classList.remove('selected');\n  });\n  categoryItem.classList.add('selected');\n\n  // Update button text\n  const btnText = document.querySelector('.dropdown-btn .dropdown-text');\n  if (btnText) {\n    btnText.textContent = selectedCategory;\n  }\n\n  // Get books for selected category\n  let books;\n  if (selectedCategory === 'All categories') {\n    books = await getTotalBooks();\n  } else {\n    books = await getBooksByCategory(selectedCategory);\n  }\n\n  // Display books\n  await displayBooks(books, {\n    selectedCategory: selectedCategory,\n    resetContent: true,\n  });\n\n  // Close dropdown\n  const dropdown = document.querySelector('#categoryDropdown');\n  dropdown.classList.remove('open');\n}\n\nexport function createDropdown(selector) {\n  const dropdown = document.querySelector(selector);\n  const btn = dropdown.querySelector('.dropdown-btn');\n  const menu = dropdown.querySelector('.dropdown-menu');\n  const text = dropdown.querySelector('.dropdown-text');\n\n  // Set initial value\n  const selected = dropdown.querySelector('.dropdown-item.selected');\n  if (selected) text.textContent = selected.textContent;\n\n  // Open/close\n  btn.onclick = () => dropdown.classList.toggle('open');\n\n  // Item selection\n  const updateSelection = selectedItem => {\n    const items = dropdown.querySelectorAll('.dropdown-item');\n    items.forEach(i => i.classList.remove('selected'));\n    selectedItem.classList.add('selected');\n    text.textContent = selectedItem.textContent;\n    dropdown.classList.remove('open');\n\n    // Callback\n    dropdown.dispatchEvent(\n      new CustomEvent('change', {\n        detail: {\n          value: selectedItem.dataset.value,\n          text: selectedItem.textContent,\n        },\n      })\n    );\n  };\n\n  menu.addEventListener('click', e => {\n    const item = e.target.closest('.dropdown-item');\n    if (item) {\n      updateSelection(item);\n    }\n  });\n\n  // Close when clicking outside element\n  document.onclick = e => {\n    if (!dropdown.contains(e.target)) {\n      dropdown.classList.remove('open');\n    }\n  };\n}\n\n// Event listeners\n\ndocument.addEventListener('DOMContentLoaded', showBooksLoader);\n\nif (showMoreBtnEl) {\n  showMoreBtnEl.addEventListener('click', handleShowMore);\n}\n\nif (dropdownMenuEl) {\n  dropdownMenuEl.addEventListener('click', handleCategoryClick);\n}\n","const scrollBtn = document.querySelector('.scroll-up');\n\nwindow.addEventListener('scroll', () => {\n  if (window.scrollY > 800) {\n    scrollBtn.classList.add('visible');\n  } else {\n    scrollBtn.classList.remove('visible');\n  }\n});\n\nscrollBtn.addEventListener('click', () => {\n  window.scrollTo({ top: 0, behavior: 'smooth' });\n});\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  const form = document.querySelector('.footer-form');\n  const input = document.querySelector('.footer-form-input');\n\n  form.addEventListener('submit', function (e) {\n    e.preventDefault();\n\n    const trimmedValue = input.value.trim();\n    if (trimmedValue === '') {\n      input.classList.add('error');\n\n      iziToast.error({\n        title: 'Error',\n        message: 'Email field cannot be empty',\n        position: 'topRight',\n        timeout: 4000,\n      });\n      return;\n    }\n\n    input.value = trimmedValue;\n\n    if (!input.checkValidity()) {\n      input.classList.add('error');\n\n      let errorMessage = 'Please enter a valid email address';\n\n      if (input.validity.valueMissing) {\n        errorMessage = 'Email field cannot be empty';\n      } else if (input.validity.typeMismatch) {\n        errorMessage = 'Please enter a valid email format (example@domain.com)';\n      } else if (input.validity.patternMismatch) {\n        errorMessage =\n          'Email format not supported. Use simple format like name@domain.com';\n      }\n\n      iziToast.error({\n        title: 'Error',\n        message: errorMessage,\n        position: 'topRight',\n        timeout: 4000,\n      });\n      return;\n    }\n\n    const existingEmails =\n      JSON.parse(localStorage.getItem('subscribedEmails')) || [];\n    if (existingEmails.some(item => item.email === trimmedValue)) {\n      input.classList.add('error');\n\n      iziToast.warning({\n        title: 'Warning',\n        message: 'You are already subscribed with this email address',\n        position: 'topRight',\n        timeout: 4000,\n      });\n      return;\n    }\n\n    saveEmailToStorage(trimmedValue);\n    input.value = '';\n\n    iziToast.success({\n      title: 'Success!',\n      message: 'Thank you! Your email has been successfully submitted.',\n      position: 'topRight',\n      timeout: 4000,\n      theme: 'light',\n    });\n  });\n\n  input.addEventListener('input', function () {\n    this.classList.remove('error');\n  });\n\n  function saveEmailToStorage(email) {\n    let emails = JSON.parse(localStorage.getItem('subscribedEmails')) || [];\n\n    emails.push({\n      email: email,\n    });\n\n    localStorage.setItem('subscribedEmails', JSON.stringify(emails));\n  }\n});\n","import iziToast from 'izitoast';\n\nconst [cartElDesktop, cartElMobile] =\n  document.querySelectorAll('.cart-open-link');\nconst [badgeElDesktop, badgeElMobile] =\n  document.querySelectorAll('.cart-badge');\nconst backdrop = document.querySelector('.js-backdrop-cart');\nconst closeBtn = document.querySelector('.js-close-btn-cart');\nconst cartList = document.querySelector('#cart-list');\nconst body = document.querySelector('body');\nconst menuEl = document.querySelector('#mobile_menu');\n\nconst STORE_CART_KEY = 'stored-cart-booksy';\nlet books = [];\nlet cartListClickHandler;\nlet cartListInputHandler;\nconst CART_PLACEHOLDER = `<div style=\"text-align:center;margin:auto;\" id=\"cart-total\">Your cart is empty</div>`;\n\nwindow.addEventListener('DOMContentLoaded', () => {\n  books = getLocalStorage(STORE_CART_KEY) ?? [];\n  setBadge(books.reduce((acc, el) => (acc += el.quantity), 0));\n});\n\nconst onCartElClick = e => {\n  e.preventDefault();\n  e.stopPropagation();\n  openModal();\n  renderCartHTML(books);\n};\n\ncartElDesktop.addEventListener('click', onCartElClick);\ncartElMobile.addEventListener('click', onCartElClick);\n\nfunction openModal() {\n  backdrop.classList.add('is-open');\n\n  if (window.innerWidth < 768) {\n    menuEl.classList.remove('mob-menu-open');\n    body.classList.remove('no-scroll');\n  }\n\n  body.classList.add('no-scroll');\n}\n\nfunction closeModal() {\n  backdrop.classList.remove('is-open');\n  const body = document.querySelector('body');\n  body.classList.remove('no-scroll');\n  const nextSibling = cartList.nextElementSibling;\n  setTimeout(() => {\n    nextSibling.remove();\n  }, 300);\n}\n\nfunction onInputChange(e) {\n  const input = e.target;\n  if (!input.classList.contains('js-qty-input')) {\n    return;\n  }\n\n  const li = input.closest('li');\n  const bookId = li.dataset.id;\n  const cartItem = findBookById(bookId, books);\n  if (!cartItem) {\n    return;\n  }\n\n  const quantityEl = li.querySelector('.quantity');\n  const totalPriceEl = li.querySelector('.total-price');\n\n  let newQty = Number(input.value);\n  if (isNaN(newQty) || newQty < 1) {\n    newQty = 1;\n  }\n\n  cartItem.quantity = newQty;\n\n  quantityEl.textContent = `q-ty: ${newQty}`;\n  totalPriceEl.textContent = `total: ${(parseFloat(cartItem.book.price) * newQty).toFixed(2)}`;\n  input.value = newQty;\n  setLocalStorage(STORE_CART_KEY, books);\n\n  setBadge(books.reduce((acc, el) => acc + el.quantity, 0));\n  updateTotal();\n}\n\nfunction onClickEvent(e) {\n  const btn = e.target;\n  if (btn.classList.contains('continue')) {\n    handleContinue();\n    return;\n  }\n\n  if (btn.classList.contains('buy')) {\n    handleBuy();\n    return;\n  }\n\n  const li = btn.closest('li');\n  if (!li) {\n    return;\n  }\n\n  const bookId = li.dataset.id;\n  const cartItem = findBookById(bookId, books);\n  if (!cartItem) {\n    return;\n  }\n\n  const quantityEl = li.querySelector('.quantity');\n  const totalPriceEl = li.querySelector('.total-price');\n  const inputEl = li.querySelector('.js-qty-input');\n\n  const price = parseFloat(cartItem.book.price);\n\n  if (btn.classList.contains('decrease')) {\n    if (cartItem.quantity > 1) {\n      cartItem.quantity -= 1;\n      e.target.blur();\n      updateItem();\n    }\n  }\n\n  if (btn.classList.contains('increase')) {\n    cartItem.quantity += 1;\n    e.target.blur();\n    updateItem();\n  }\n\n  if (btn.classList.contains('js-remove-book')) {\n    removeItem();\n  }\n\n  function updateItem() {\n    const newQty = cartItem.quantity;\n    quantityEl.textContent = `q-ty: ${newQty}`;\n    totalPriceEl.textContent = `total: ${(price * newQty).toFixed(2)}$`;\n    inputEl.value = newQty;\n\n    setBadge(books.reduce((acc, el) => acc + el.quantity, 0));\n    setLocalStorage(STORE_CART_KEY, books);\n    updateTotal();\n  }\n  function handleBuy() {\n    clearCart();\n    closeModal();\n\n    iziToast.success({\n      title: 'Hello',\n      message: 'Thank you for your purchase!',\n      position: 'topRight',\n    });\n  }\n  function handleContinue() {\n    closeModal();\n  }\n\n  function removeItem() {\n    const { success } = removeFromCart(bookId);\n    if (success) {\n      setBadge(books.reduce((acc, el) => acc + el.quantity, 0));\n      li.remove();\n      setLocalStorage(STORE_CART_KEY, books);\n      updateTotal();\n    } else {\n      console.warn('Woops');\n    }\n  }\n}\n\nconst onCloseBtnClick = e => {\n  closeModal();\n};\n\ncloseBtn.addEventListener('click', onCloseBtnClick);\nbackdrop.addEventListener('click', e => {\n  if (e.target === e.currentTarget) {\n    closeModal();\n  }\n});\n\nfunction findBookById(id) {\n  const book = books.find(cartItem => cartItem.book._id === id);\n  return book;\n}\n\nfunction addToCart(book, quantity = 1) {\n  const bookId = book._id;\n  const bookIndex = books.findIndex(cartItem => cartItem.book._id === bookId);\n\n  if (bookIndex === -1) {\n    const bookData = {\n      quantity,\n      book,\n    };\n    books.push(bookData);\n  } else {\n    books[bookIndex].quantity += quantity;\n  }\n  const totalQuantity = books.reduce((acc, el) => (acc += el.quantity), 0);\n  setBadge(totalQuantity);\n  setLocalStorage(STORE_CART_KEY, books);\n}\n\nfunction removeFromCart(id) {\n  const bookIndex = books.findIndex(cartItem => cartItem.book._id === id);\n\n  if (bookIndex < 0) {\n    return { success: false };\n  } else {\n    books.splice(bookIndex, 1);\n    setLocalStorage(STORE_CART_KEY, books);\n    return { success: true };\n  }\n}\n\n// function setBadge(quantity) {\n//   if (!quantity) {\n//     badgeElDesktop.textContent = '';\n//     badgeElMobile.textContent = '';\n//     ('visually-hidden');\n//     return;\n//   }\n\n//   badgeElDesktop.textContent = quantity;\n//   badgeElMobile.textContent = quantity;\n// }\n\nfunction setBadge(quantity) {\n  const isHiddenDesktop = badgeElDesktop.classList.contains('visually-hidden');\n  const isHiddenMobile = badgeElMobile.classList.contains('visually-hidden');\n\n  if (!quantity) {\n    badgeElDesktop.textContent = '';\n    badgeElMobile.textContent = '';\n\n    if (!isHiddenDesktop) {\n      badgeElDesktop.classList.add('visually-hidden');\n    }\n    if (!isHiddenMobile) {\n      badgeElMobile.classList.add('visually-hidden');\n    }\n    return;\n  }\n\n  const displayQuantity = quantity > 99 ? '99+' : quantity;\n\n  badgeElDesktop.textContent = displayQuantity;\n  badgeElMobile.textContent = displayQuantity;\n\n  if (isHiddenDesktop) {\n    badgeElDesktop.classList.remove('visually-hidden');\n  }\n  if (isHiddenMobile) {\n    badgeElMobile.classList.remove('visually-hidden');\n  }\n}\n\nfunction clearCart() {\n  books = [];\n  setLocalStorage(STORE_CART_KEY, []);\n  setBadge(0);\n}\n\nfunction getLocalStorage(key) {\n  const stored = localStorage.getItem(key);\n\n  return stored ? JSON.parse(stored) : null;\n}\n\nfunction setLocalStorage(key, value) {\n  localStorage.setItem(\n    key,\n    typeof value === 'string' ? value : JSON.stringify(value)\n  );\n}\n\n// todo implement cleanup on unmount cart modal;\n\nfunction renderCartHTML(books) {\n  function generateCartMarkup(books) {\n    return books\n      .map(cartItem => {\n        const { book: b, quantity } = cartItem;\n\n        return `<li class=\"cart-item-inner\" data-id=\"${b._id}\">\n        <div class=\"purchase-item-content\">\n                  <div class=\"purchase-item-head\">\n                  <p>${b.title}</p>\n                    <img class=\"cart-item-img\" src=\"${b.book_image}\" alt=\"${b.title}\" />\n                  </div>\n\n                  </div>\n                  <div class=\"enter-value\">\n                  <div>\n                    <p>price: ${parseFloat(b.price).toFixed(2)}$</p>\n                    <p class=\"quantity\">q-ty: ${quantity}</p>\n                    <p class=\"total-price\">total: ${(parseFloat(b.price) * quantity).toFixed(2)}$</p>\n                  </div>\n                    <div class=\"qty-group\">\n                      <button class=\"enter-value-btn decrease\">-</button>\n                      <input min=\"1\" class=\"js-qty-input qty-input\" value=\"${quantity}\" />\n                      <button class=\"enter-value-btn increase\">+</button>\n                    </div>\n                    <button class=\"js-remove-book remove-book\">remove</button>\n                  </div>\n                </li>`;\n      })\n      .join('');\n  }\n\n  function generateTotalBlock() {\n    const totalPrice = books\n      .reduce((acc, el) => (acc += el.quantity * parseFloat(el.book.price)), 0)\n      .toFixed(2);\n    const totalQty = books.reduce((acc, el) => (acc += el.quantity), 0);\n\n    if (!parseInt(totalPrice) || !totalQty) {\n      return CART_PLACEHOLDER;\n    }\n\n    return ` <div class=\"cart-total\" id=\"cart-total\">\n              <ul>\n                <li>\n                <p id=\"cart-total-price\">Total: ${totalPrice}$</p>\n                <p id=\"cart-total-qty\">Amount: ${totalQty}</p>\n                </li>\n              </ul>\n              <ul class=\"total-buttons\">\n                <li><button class=\"remove-book continue\">Keep shopping</button></li>\n                <li><button class=\"remove-book buy\">BUY</button></li>\n              </ul>\n            </div>`;\n  }\n\n  cartList.innerHTML = generateCartMarkup(books);\n  cartList.insertAdjacentHTML('afterend', generateTotalBlock());\n  const nextSibling = cartList.nextElementSibling;\n\n  cartListClickHandler = onClickEvent;\n  cartListInputHandler = onInputChange;\n\n  nextSibling.addEventListener('click', cartListClickHandler);\n  cartList.addEventListener('click', cartListClickHandler);\n  cartList.addEventListener('input', cartListInputHandler);\n}\n\nfunction updateTotal() {\n  const totalEl = backdrop.querySelector('#cart-total');\n  const totalPriceEl = totalEl.querySelector('#cart-total-price');\n  const totalQtyEl = totalEl.querySelector('#cart-total-qty');\n\n  const totalPrice = books\n    .reduce((acc, el) => (acc += el.quantity * parseFloat(el.book.price)), 0)\n    .toFixed(2);\n  const totalQty = books.reduce((acc, el) => (acc += el.quantity), 0);\n\n  if (!parseInt(totalPrice) || !totalQty) {\n    totalEl.innerHTML = CART_PLACEHOLDER;\n    return;\n  }\n\n  totalPriceEl.textContent = `Total: ${totalPrice}$`;\n  totalQtyEl.textContent = `Amount: ${totalQty}`;\n}\nexport { addToCart, renderCartHTML };\n","import Accordion from 'accordion-js';\nimport 'accordion-js/dist/accordion.min.css';\nimport { body } from './header';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { getBooksById } from './api.js';\nimport { topBooksListEl } from './render-functions.js';\nimport { addToCart } from './cart.js';\n\nconst accordionInstance = new Accordion('#accordion', { showMultiple: true });\nconst textWrapperEl = document.querySelector('#text-wrap-modal-books');\nconst accordionEl = document.querySelector('#accordion');\nconst modalBooksEl = document.querySelector('#modal-books');\nconst formEl = document.querySelector('#book-modal-form');\nconst cartEl = document.querySelector('#cart-button');\nconst dynamicText = modalBooksEl.querySelector('#dynamic-text');\n\nlet bookId;\n\n// ? Елементи лічильника кількості книжок, що добавляються в корзину.\nconst quantityEl = document.querySelector('#quantity-wrapper');\nconst decreaseEl = quantityEl.children[0];\nconst inputEl = quantityEl.children[1];\nconst increaseEl = quantityEl.children[2];\n\n// ? Змінна відповідає за кількість товарів в корзині і айді книжки\nexport let totalQuantity = 0;\nexport let bookCartId;\n\n// ? Відкриття модального вікна\nconst modalOpen = async e => {\n  if (e.target.classList.contains('top-book-btn')) {\n    modalBooksEl.classList.add('books-window-is-open');\n    body.classList.add('no-scroll');\n    inputEl.value = 1;\n    // ? Дістаєм найближчий елемент списку, читаєм його айді.\n    let bookListEl = e.target.closest('li');\n    bookId = bookListEl.id;\n\n    // ? Якщо айді присутній, відправляється запит по айдішнику і виконується розмітка. Якщо ні, виводиться помилка і модальне вікно закривається.\n    if (bookId) {\n      try {\n        const bookData = await getBooksById(bookId);\n        markupHandler(bookData);\n      } catch (err) {\n        iziToast.error({\n          title: 'Error',\n          message: `Failed to fetch book data: ${err}`,\n          position: 'topRight',\n        });\n      }\n    } else {\n      iziToast.error({\n        title: 'Error',\n        message: `Book ID not found`,\n        position: 'topRight',\n      });\n      modalBooksEl.classList.remove('books-window-is-open');\n      body.classList.remove('no-scroll');\n    }\n  }\n};\ntopBooksListEl.addEventListener('click', modalOpen);\n\nconst markupCleaner = () => {\n  const dynamicAccordion = accordionEl.querySelector('.ac-dynamic');\n  if (dynamicAccordion) dynamicAccordion.remove();\n\n  const bookImage = modalBooksEl.querySelector('.books-modal-image');\n  if (bookImage) bookImage.remove();\n\n  if (dynamicText) dynamicText.innerHTML = '';\n};\n\nconst capitalizeTitle = str => {\n  return str\n    .toLowerCase()\n    .split(' ')\n    .map(word => word.charAt(0).toUpperCase() + word.slice(1))\n    .join(' ');\n};\n\n\nconst markupHandler = ({\n                         title,\n                         description,\n                         author,\n                         book_image,\n                         book_image_width,\n                         book_image_height,\n                         price,\n                       }) => {\n  markupCleaner();\n  if (description === '') {\n    description = 'There is no description for this book.';\n  }\n\n  const formattedTitle = capitalizeTitle(title);\n\n  textWrapperEl.insertAdjacentHTML(\n    'beforebegin',\n    `<img class=\"books-modal-image\" loading=\"lazy\" src=\"${book_image}\" width=\"${book_image_width}\" height=\"${book_image_height}\" alt=\"${formattedTitle}\">`\n  );\n\n  dynamicText.insertAdjacentHTML(\n    'afterbegin',\n    `<h2 class=\"book-title-modal\">${formattedTitle}</h2>\n     <h3 class=\"book-author-modal\">${author}</h3>\n     <h3 class=\"book-price\">$${price}</h3>`\n  );\n\n  accordionEl.insertAdjacentHTML(\n    'afterbegin',\n    `<div class=\"ac ac-dynamic\">\n        <h2 class=\"ac-header\">\n          <button type=\"button\" class=\"ac-trigger\">Details\n            <span class=\"chevron-span\">\n              <svg class=\"icon-chevron\" width=\"24\" height=\"25\">\n                <use\n                  class=\"chevron-use\"\n                  href=\"./img/icons.svg#icon-chevron-down\"\n                ></use>\n              </svg>\n            </span></button>\n        </h2>\n        <div class=\"ac-panel\">\n          <p class=\"ac-text\">\n            ${description}\n          </p>\n        </div>\n      </div>`\n  );\n\n  accordionInstance.update();\n};\n\n// ? Функціонал кнопок відняти/додати\nconst increaseHandler = e => {\n  e.target.blur();\n  inputEl.value = Number(inputEl.value) + 1;\n};\nconst decreaseHandler = e => {\n  e.target.blur();\n  if (Number(inputEl.value) != 1) {\n    inputEl.value = Number(inputEl.value) - 1;\n  }\n};\nincreaseEl.addEventListener('click', increaseHandler);\ndecreaseEl.addEventListener('click', decreaseHandler);\n\n// ? Логіка кнопки корзини\nconst cartHandler = e => {\n  e.target.blur();\n  totalQuantity += Number(inputEl.value); //? Відповідає за кількість цієї книжки у корзині\n  bookCartId = bookId; // ? Відповідає за айді книжки у корзині\n  getBooksById(bookCartId)\n    .then(book => {\n      if (book) {\n        addToCart(book, Number(inputEl.value));\n      } else {\n        iziToast.error({\n          title: 'Error',\n          message: `Failed to add book to the cart!`,\n          position: 'topRight',\n        });\n      }\n    })\n    .catch(console.error);\n\n  iziToast.info({\n    title: 'Hello',\n    message: `Successfully added ${inputEl.value} item(s) to the cart!`,\n    position: 'topRight',\n  });\n};\ncartEl.addEventListener('click', cartHandler);\n\n// ? Логіка кнопки купити\nconst onSubmit = e => {\n  e.preventDefault();\n  e.target.blur();\n  iziToast.success({\n    title: 'Hello',\n    message: 'Thank you for your purchase!',\n    position: 'topRight',\n  });\n};\nformEl.addEventListener('submit', onSubmit);\n\n// ? Відповідає за закривання вікна на кнопку закриття, бекдроп або кнопку купівлі, а також нажату клавішу Escape\nconst modalCloseClickHandler = e => {\n  if (\n    e.target.classList.contains('mob-books-close') ||\n    e.target.classList.contains('modal-window-books-backdrop') ||\n    e.target.classList.contains('buy-button')\n  ) {\n    modalBooksEl.classList.remove('books-window-is-open');\n    body.classList.remove('no-scroll');\n  }\n};\nconst modalEscapeHandler = e => {\n  if (e.key === 'Escape') {\n    modalBooksEl.classList.remove('books-window-is-open');\n    body.classList.remove('no-scroll');\n  }\n};\ndocument.addEventListener('keydown', modalEscapeHandler);\nmodalBooksEl.addEventListener('click', modalCloseClickHandler);\n"],"names":["Swiper","Navigation","Pagination","el","getRandomFutureTime","daysAhead","now","future","options","modal","backdrop","closeBtn","form","STORAGE_KEY","nameInput","emailInput","messageInput","isValidEmail","email","saveToStorage","formData","restoreFromStorage","saved","data","iziToast","clearStorage","openButtons","subtitleEl","btn","e","subtitle","openModal","closeModal","input","name","hasError","error","burgerEl","menuEl","navListEl","body","onBurgerClick","closeMenuHandler","button","navLink","hideElement","header","badgeEl","swiper","Keyboard","getCurrentSlidesPerGroup","width","togglePaginationAndNavigation","totalSlides","currentGroup","paginationEl","prevBtn","nextBtn","Autoplay","SLIDES","wrapperContainer","generateMarkup","arr","slide","createGallery","slides","axios","categoriesCache","totalBooksCache","getCategoryList","filteredCategories","category","getTopBooks","getBooksByCategory","encodedCategory","getBooksById","id","getTotalBooks","categories","categoryNames","allBooks","uniqueTitles","filteredBooks","book","normalizedTitle","topBooksListEl","dropdownMenuEl","showMoreBtnEl","showCountEl","booksWrapperEl","booksLoaderEl","allTopBooks","page","currentCategory","INITIAL_CATEGORY","getTotalBooksCount","displayBooks","books","isInitialLoad","selectedCategory","resetContent","clearBooksContent","resetPage","filterBooks","updateAllBooks","booksPerScreen","getBooksPerScreen","initialBooks","setPaginationValue","createTopBooksList","showEmptyState","initializeCategories","updateBooksCounter","toggleShowMoreButton","showErrorState","markup","filterValidCategories","createCategoryBooksList","categoryName","item","createShowCase","count","total","getPage","incrementPage","showShowMoreBtn","hideShowMoreBtn","allCategories","categoryPromises","categoriesWithBooks","result","hideBooksLoader","totalCount","renderedCount","getPaginationValue","shouldShow","showBooksLoader","extractBooksFromCategories","categoriesData","showLoadingState","loadingEl","hideLoadingState","showInitializationError","initializeApp","topBooksData","createDropdown","selector","dropdown","text","items","selected","i","perPage","paginationValue","value","handleShowMore","start","end","nextBooks","firstItemEl","cardHeight","handleCategoryClick","event","categoryItem","btnText","scrollBtn","trimmedValue","errorMessage","saveEmailToStorage","emails","cartElDesktop","cartElMobile","badgeElDesktop","badgeElMobile","cartList","STORE_CART_KEY","cartListClickHandler","cartListInputHandler","CART_PLACEHOLDER","getLocalStorage","setBadge","acc","onCartElClick","renderCartHTML","nextSibling","onInputChange","li","bookId","cartItem","findBookById","quantityEl","totalPriceEl","newQty","setLocalStorage","updateTotal","onClickEvent","handleContinue","handleBuy","inputEl","price","updateItem","removeItem","clearCart","success","removeFromCart","onCloseBtnClick","addToCart","quantity","bookIndex","bookData","totalQuantity","isHiddenDesktop","isHiddenMobile","displayQuantity","key","stored","generateCartMarkup","b","generateTotalBlock","totalPrice","totalQty","totalEl","totalQtyEl","accordionInstance","Accordion","textWrapperEl","accordionEl","modalBooksEl","formEl","cartEl","dynamicText","decreaseEl","increaseEl","bookCartId","modalOpen","markupHandler","err","markupCleaner","dynamicAccordion","bookImage","capitalizeTitle","str","word","title","description","author","book_image","book_image_width","book_image_height","formattedTitle","increaseHandler","decreaseHandler","cartHandler","onSubmit","modalCloseClickHandler","modalEscapeHandler"],"mappings":"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"}